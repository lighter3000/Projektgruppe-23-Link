<html>

<head>
    <meta charset="utf-8">

    <script type="text/javascript" src="lib/brython.js"></script>
    <script type="text/javascript" src="lib/brython_stdlib.js"></script>
    <script type="text/javascript" src="lib/codemirror.js"></script>
    <script type="text/javascript" src="lib/qrcode.min.js"></script>

    <script type="text/python" src="code-editor.py"></script>

    <script type="text/javascript" src="tab-space.js"></script>

    <link rel="stylesheet" href="lib/codemirror.css">
    <link rel="stylesheet" href="styling.css">

    <title>Code-Editor turtle graphics/brython</title>
</head>

<body onload="brython()">
    <!--                             Navbar                                       -->
    <div class="navbar-container">
        <div class="navbar-container-left">
            <h3 class="navbar-title">Webanwendung auf Basis von turtle graphics und brython</h3>
            <!--                         Level Select Buttons                         -->
            <button id="previous_level" class="navbar-button-left next-previous-button">-</button>
            <h3 id="level_title" class="level-title">Level 1</h3>
            <button id="next_level" class="navbar-button-left next-previous-button">+</button>
        </div>
        <div class="navbar-container-right ">
            <!--                         Dropdown                                     -->
            <div id="dropdown" class="dropdown">
                <button id="dropdown-button" class="dropdown-button">Exportieren</button>
                <ul id="dropdown-menu" class="dropdown-menu">
                    <li><button id="export_download" class="dropdown-button">Download</button></li>
                    <li><button id="export_print" class="dropdown-button">Drucken</button></li>
                    <li><button id="export_qrcode" class="dropdown-button">QR-Code</button></li>
                </ul>
            </div>
            <!--                         Dark Mode Button                             -->
            <button id="dark-mode-button" class="navbar-button-right darkmode-button">Dark Mode</button>
        </div>

    </div>
    <!--                             2 Container on left and right                -->
    <div class="side-content-container">
        <!--                         Left Container                               -->
        <div class="side-container side-left">
            <div class="vertical-spacer"></div>
            <!--                     Tutorial Container                           -->
            <div class="tutorial-container area-container" id="tutorial-area">
                <div id="tutorial" class="tutorial"></div>
            </div>
            <div class="vertical-spacer"></div>
            <!--                     Code-Editor Container                        -->
            <div class="code-editor-container area-container" id="code-editor-area">
                <!--<div class="code-area">
                    <div class="source-code-container" id="source-code-area">
                        <pre
                            class="pre-block" id="code-editor-pre"><code class="code-block" contenteditable="true" spellcheck="false" data-gramm="false"><span  id="code-editor-source" class="code-editor-font"></span></code></pre>
                    </div>
                </div>
                --->
                <span id="code-editor-source" class="code-editor-font" style="height:100%"></span>
            </div>
            <div class="vertical-spacer"></div>
            <!--                     Run and Debug Buttons Container              -->
            <div class="button-container" id="button-area">
                <button id="run_code" class="run-button" tabindex="-1">Run</button>
                <button id="reset_code" class="reset-button button-right"
                    title="Der aktuelle Code wird auf den Anfangscode zurückgesetzt" tabindex="-1">Reset</button>
                <button id="load_code" class="buttons button-right"
                    title="Der zuletzt gespeicherte Code wird geladen" tabindex="-1">Load</button>
                <button id="save_code" class="buttons button-right" title="Aktueller Code wird gespeichert"
                    tabindex="-1">Save</button>
                <button id="show_solution" class="solution-button button-right" tabindex="-1">Lösung</button>
            </div>

            <div class="vertical-spacer"></div>
        </div>
        <!--                         Right Container                              -->
        <div class="side-container side-right">
            <div class="vertical-spacer"></div>
            <!--                     Canvas Container                             -->
            <div class="canvas-container area-container" id="canvas-area">
                <p class="canvas-container-text">Canvas</p>
                <div id="canvas" class="canvas"></div>
            </div>

            <div class="vertical-spacer"></div>
            <!--                     Console Container                            -->
            <div class="console-container area-container" id="console-area">
                <p class="console-container-text">Konsole</p>
                <div class="console" id="console"></div>
            </div>
            <div class="vertical-spacer"></div>
        </div>
    </div>
    <!--                     QR-Code Modal                                        -->
    <div id="qrcodeModal" class="modal">
        <div id="qrcode-modal-content" class="qrcode-modal-content">
            <span class="close" id="qrCodeModalCloseButton">&times;</span>
            <p id="message" class="modal-elements">Warten auf Upload ...</p>
            <div id="qrCodeToDownload" class="modal-elements"></div>
            <a id="linkToDownload" class="modal-elements"></a>
            <p id="errorMessage" class="modal-elements error-message"></p>
        </div>
    </div>
    <!--                     Solution Modal                                       -->
    <div id="solutionModal" class="modal">
        <div id="solution-modal-content" class="solution-modal-content">
            <div class="close-container">
                <span class="close" id="solutionCodeModalCloseButton">&times;</span>
            </div>
            <div id="solution_code_container" style="display: none;" class="solution-step-container">
                <h4 class="solution-modal-title">Vollständige Lösung</h4>
                <div class="solution-code-container">
                    <pre
                        class="pre-block"><code spellcheck="false" data-gramm="false"><span  id="solution_code" class="code-editor-font"></span></code></pre>
                </div>
                <div class="modal-spacer"></div>
                <div class="solution-button-container">
                    <button id="paste_solution" class="paste-solution-button">In Code-Editor einfügen</button>
                </div>
                <div class="modal-spacer"></div>
            </div>

            <div id="solution_comments_container" class="solution-step-container">
                <h4 class="solution-modal-title">Kommentare zur Lösung (Vollständige Lösung mit Passwort)</h4>
                <div class="solution-code-container">
                    <pre
                        class="pre-block"><code spellcheck="false" data-gramm="false"><span  id="solution_comments" class="code-editor-font"></span></code></pre>
                </div>
                <div class="modal-spacer"></div>
                <div class="solution-button-container">
                    <input type="password" id="solution_password" class="solution-password"
                        placeholder="Passwort für Code-Lösung">
                    <button id="show_solution_code" class="solution-password-button">></button>
                </div>
                <div class="modal-spacer"></div>
            </div>
        </div>
    </div>
    <div id="levelsContainer" class="levels-container" hidden>

        <head>
            <meta charset="utf-8">

            <style>
                .code-hint {
                    border-left: #8787872a solid 20px;
                    padding-left: 10px;
                }

                .code-hint-font {
                    font-size: 14px;
                }

                .code-editor-font {
                    font-size: 14px;
                }

                .levels-container {
                    margin: 100px;
                }

                .first-level-container {
                    margin-top: 100px;
                }

                .empty-level-container {
                    margin-bottom: 100px;
                }
                .code-container {
                    height: max-content;
                    margin-bottom: 20px;
                }
            </style>

            <script>
                function resetAnimations(svg) {
                    svg.setCurrentTime(0)
                    svg.unpauseAnimations()
                }

                function setEventListenersOnEndOfLastFrame() {
                    var svgElements = document.querySelectorAll('#levelsContainer svg');

                    svgElements.forEach(svg => {
                        const animateElements = svg.querySelectorAll(['animate', 'animateMotion', 'animateTransform']);
                        const lastFrame = animateElements[animateElements.length - 1];

                        lastFrame.addEventListener("endEvent", () => {
                            setTimeout(() => {
                                resetAnimations(svg);
                            }, 2000)
                        });
                    });
                }

                window.addEventListener('load', () => {
                    setEventListenersOnEndOfLastFrame()
                }); 
            </script>
        </head>

        <body>

        <h1>Deine Coding-Ergebnisse</h1>

        </body>
    </div>
</body>

</html>